<% if ads.length > 0 %>

<table class="ads-table tablesaw tablesaw-stack" data-tablesaw-mode="stack">
	<thead>
		<th>Title</th>
		<th class="text-right">Price</th>
		<% if current_view == "archive" -%>
			<th class="text-right">Final Price</th>
			<th>Buyer</th>
		<% end -%>
		<th>Published</th>
		<% if current_view == "archive" -%>
			<th>Archived</th>
		<% end -%>
		<th class="text-right">Displayed</th>
		<th class="text-right">Displayed contact info</th>
		<th class="text-right">Favorites</th>
		<% if current_view == "current" -%>
			<th></th>
		<% end -%>
	</thead>
	<tbody>
	<% ads.each do |ad| -%>
		<tr>
			<td>
				<h4 class="ads-table-heading"><%= link_to ad.title, ad_path(ad) %></h4>
			</td>
			<td class="text-right"><%= number_to_currency(ad.price) %></td>
			<% if current_view == "archive" -%>
				<td class="text-right"><%= number_to_currency(ad.final_price) %></td>
				<td><%= ad.buyer.name %></td>
			<% end -%>
			<td><%= l(ad.published_at, format: :short) %></td>
			<% if current_view == "archive" -%>
				<td><%= l(ad.archived_at, format: :short) %></td>
			<% end -%>
			<td class="text-right">
				<% displayed = ad.ad_logs.where(:event_type_id => 1).group(:event_type).count %>
				<% if displayed.length > 0 %>
					<% displayed.each do |s| %>
						<%=  s[1] %>
					<% end -%>
				<% else -%>
					0
				<% end -%>
			</td>
			<td class="text-right">
				<% contact_displayed = ad.ad_logs.where(:event_type_id => 2).group(:event_type).count %>
				<% if contact_displayed.length > 0 %>
					<% contact_displayed.each do |s| %>
						<%=  s[1] %>
					<% end -%>
				<% else -%>
					0
				<% end -%>
			</td>
			<td class="text-right">
				<%= ad.favorited_by.count%>
			</td>
			<% if current_view == "current" -%>
			<td class="text-right"><%= link_to("Archive", archive_ad_path(ad), :class => "button is-block is-primary ads-table-button") %></td>
			<% end -%>
		</tr>
	<% end -%>
	</tbody>
</table>
<!-- <div class="ads is-current">
	<% ads.each do |ad| -%>
		<div data-url="<%= ad_path(ad) %>" class="ads-item has-actions">

			<h2 class="ads-heading">
				<%= link_to ad.title, ad_path(ad) %>
			</h2>
			<div class="ads-location">
				<%= number_to_currency(ad.price) %>
			</div>
			<div class="ads-actions">
				<%= link_to("Sold", archive_ad_path(ad), :class => "ads-actions-item button is-primary") %>
			</div>
		</div>
	<% end -%>
</div>
 -->
<% else -%>
	<% if current_view = "current" -%>
		<p>No ads to show</p>
	<% end -%>
<% end -%>